<ion-header >
  <ion-toolbar color="primary">
    <ion-title> Detalles del Dispositivo N° {{ dispositivoId }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="dispositivo">
  <ion-card class="device-detail-card">
    <ion-grid>
      <ion-row>
        <!-- Texto a la izquierda -->
        <ion-col size="12" size-md="7">
          <ion-card-content>
            <p><strong>Ubicación:</strong> {{ dispositivo.ubicacion }}</p>

            <p>
              <strong>Válvula:</strong>
              <ng-container *ngIf="estadoValvula !== null; else cargandoValvula">
                <ion-chip [color]="estadoValvula ? 'success' : 'danger'">
                  {{ estadoValvula ? 'Abierta' : 'Cerrada' }}
                </ion-chip>
              </ng-container>
              <ng-template #cargandoValvula>
                Cargando estado...
              </ng-template>
            </p>

            <div class="ultima-medicion">
              <ng-container *ngIf="ultimaMedicion; else noMediciones">
                <p><strong>Última Medición:</strong></p>
                <p>Fecha: {{ ultimaMedicion.fecha }}</p>
                <p>Valor: {{ ultimaMedicion.valor }}</p>
              </ng-container>
              <ng-template #noMediciones>
                <p>No hay mediciones registradas.</p>
              </ng-template>
            </div>

            <!-- Botones de válvula -->
            <div class="botones-valvula">
              <ion-button expand="block" color="success" (click)="abrirValvula()">Abrir Válvula</ion-button>
              <ion-button expand="block" color="danger" (click)="cerrarValvula()">Cerrar Válvula</ion-button>
            </div>
          </ion-card-content>
        </ion-col>

        <!-- Imagen a la derecha -->
        <ion-col size="12" size-md="5" class="device-image">
          <img [src]="estadoValvula ? 'assets/img/version2.png' : 'assets/img/version1.png'" 
              alt="Imagen dispositivo" />
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card>

  <!-- Botones generales fuera de la tarjeta -->
  <div class="botones-generales">
    <ion-button expand="block" color="primary" (click)="verMediciones()">Mostrar Mediciones</ion-button>
    <ion-button expand="block" fill="outline" color="medium" (click)="volverAlHome()">Volver al Home</ion-button>
  </div>
</ion-content>
